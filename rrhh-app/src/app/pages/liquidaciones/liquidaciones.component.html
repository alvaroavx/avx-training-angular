<div class="container my-3">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="m-0">Liquidaciones</h2>

    <button class="btn btn-primary" (click)="onCrear()">
      + Nueva liquidación
    </button>
  </div>

  <!-- Estado de carga -->
  <div *ngIf="cargando" class="alert alert-info">Cargando...</div>

  <!-- Contenido cuando no está cargando -->
  <ng-container *ngIf="!cargando">
    <!-- Resolver el observable -->
    <ng-container *ngIf="(liquidaciones$ | async) as liquidaciones">
      <!-- Estado vacío -->
      <div *ngIf="liquidaciones.length === 0" class="alert alert-secondary">
        No hay liquidaciones registradas.
      </div>

      <!-- Tabla -->
      <div *ngIf="liquidaciones.length > 0" class="table-responsive">
        <table class="table table-striped align-middle">
          <thead>
            <tr>
              <th>ID</th>
              <th>Empleado</th>
              <th>Mes/Año</th>
              <th class="text-end">Sueldo base</th>
              <th class="text-end">Impuestos</th>
              <th class="text-end">Pago total</th>
              <th>Estado</th>
              <th class="text-end">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let liq of liquidaciones; trackBy: trackById">
              <td>{{ liq.id }}</td>
              <td>#{{ liq.empleadoId }}</td>
              <td>{{ (liq.mes | number:'2.0-0') }}/{{ liq.anio }}</td>
              <td class="text-end">{{ liq.sueldoBase | currency:'CLP':'symbol':'1.0-0' }}</td>
              <td class="text-end">{{ liq.impuestos  | currency:'CLP':'symbol':'1.0-0' }}</td>
              <td class="text-end fw-semibold">{{ liq.pagoTotal | currency:'CLP':'symbol':'1.0-0' }}</td>
              <td>
                <span
                  class="badge"
                  [ngClass]="{
                    'text-bg-success': liq.estado === 'Pagado',
                    'text-bg-warning': liq.estado === 'Pendiente',
                    'text-bg-danger':  liq.estado === 'Rechazado'
                  }"
                >
                  {{ liq.estado }}
                </span>
              </td>
              <td class="text-end">
                <button class="btn btn-sm btn-outline-secondary me-1" (click)="onVer(liq)">Ver</button>
                <button class="btn btn-sm btn-outline-primary me-1" (click)="onEditar(liq)">Editar</button>
                <!-- <button class="btn btn-sm btn-outline-danger" (click)="onEliminar(liq)">Eliminar</button> -->
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </ng-container>
  </ng-container>
</div>
